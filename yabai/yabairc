#!/usr/bin/env sh
alias rule="yabai -m rule --add"
alias config="yabai -m config"


# global settings
config mouse_follows_focus          off
config focus_follows_mouse          on
config window_placement             second_child
config window_topmost               off
config window_shadow                off
config window_opacity               off
config window_opacity_duration      2
config active_window_opacity        1.0
config normal_window_opacity        0.9
config window_border                off
config window_border_width          3
config active_window_border_color   0xccffffff
config normal_window_border_color   0xff555555
config insert_feedback_color        0xffd75f5f
config split_ratio                  0.50
config auto_balance                 off
config mouse_modifier               ctrl
config mouse_action1                move
config mouse_action2                resize
config mouse_drop_action            swap

# general space settings
config layout                       bsp
config top_padding                  32
config bottom_padding               8
config left_padding                 8
config right_padding                8
config window_gap                   06



##############
# EXCEPTIONS #
##############

rule app="Préférences Système|Keka|Drop" manage=off
rule title="Discord Updater" manage=off
rule title='^Ouverture$' manage=off layer=above




###############
# HOME LAYOUT #
###############

# Number of spaces on display 1
d1s=$(yabai -m query --spaces --display 1 | jq length)

# Firefox to space 1 of display 1
rule app="Firefox" space=1

# Spotify to space 1 of display 2
rule app="Spotify" space=$(($d1s+1))

# Discord to space 2 of display 2
rule app="Discord" space=$(($d1s+2))

# Twitterrific to space 3 of display 2
rule app="Twitterrific" space=$(($d1s+3))

# Messages to space 3 of display 2
rule app="Messages" space=$(($d1s+3))




###################
# ÛBERSICHT STUFF #
###################

# Refresh spaces widget on space change
yabai -m signal --add event=space_changed action="osascript -e 'tell application id \"tracesOf.Uebersicht\" to refresh widget id \"simple-bar-spaces-jsx\"'"
# Refresh spaces widget on display focus change
yabai -m signal --add event=display_changed action="osascript -e 'tell application id \"tracesOf.Uebersicht\" to refresh widget id \"simple-bar-spaces-jsx\"'"
# Refresh process widget on space change
yabai -m signal --add event=space_changed action="osascript -e 'tell application id \"tracesOf.Uebersicht\" to refresh widget id \"simple-bar-process-jsx\"'"
# Uncomment next line to enable spaces widget refresh on your 2nd monitor
yabai -m signal --add event=space_changed action="osascript -e 'tell application id \"tracesOf.Uebersicht\" to refresh widget id \"simple-bar-spaces-2-jsx\"'"

# Refresh process widget on when focused application changes
yabai -m signal --add event=window_focused action="osascript -e 'tell application id \"tracesOf.Uebersicht\" to refresh widget id \"simple-bar-process-jsx\"'"
# Refresh spaces widget on when focused application changes
yabai -m signal --add event=window_focused action="osascript -e 'tell application id \"tracesOf.Uebersicht\" to refresh widget id \"simple-bar-spaces-jsx\"'"
# Uncomment next line to enable spaces widget refresh on your 2nd monitor
yabai -m signal --add event=window_focused action="osascript -e 'tell application id \"tracesOf.Uebersicht\" to refresh widget id \"simple-bar-spaces-2-jsx\"'"

# Refresh process widget on when focused application changes
yabai -m signal --add event=application_front_switched action="osascript -e 'tell application id \"tracesOf.Uebersicht\" to refresh widget id \"simple-bar-process-jsx\"'"
# Refresh spaces widget on when focused application changes
yabai -m signal --add event=application_front_switched action="osascript -e 'tell application id \"tracesOf.Uebersicht\" to refresh widget id \"simple-bar-spaces-jsx\"'"
# Uncomment next line to enable spaces widget refresh on your 2nd monitor
yabai -m signal --add event=application_front_switched action="osascript -e 'tell application id \"tracesOf.Uebersicht\" to refresh widget id \"simple-bar-spaces-2-jsx\"'"

# Refresh process widget on when an application window is closed
yabai -m signal --add event=window_destroyed action="osascript -e 'tell application id \"tracesOf.Uebersicht\" to refresh widget id \"simple-bar-process-jsx\"'"
# Refresh spaces widget on when an application window is closed
yabai -m signal --add event=window_destroyed action="osascript -e 'tell application id \"tracesOf.Uebersicht\" to refresh widget id \"simple-bar-spaces-jsx\"'"
# Uncomment next line to enable spaces widget refresh on your 2nd monitor
yabai -m signal --add event=window_destroyed action="osascript -e 'tell application id \"tracesOf.Uebersicht\" to refresh widget id \"simple-bar-spaces-2-jsx\"'"

# Refresh process widget when current window title changes
yabai -m signal --add event=window_title_changed action="osascript -e 'tell application id \"tracesOf.Uebersicht\" to refresh widget id \"simple-bar-process-jsx\"'"
